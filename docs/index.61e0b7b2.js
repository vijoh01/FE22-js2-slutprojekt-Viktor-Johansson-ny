function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},o={},r=n.parcelRequire3a97;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},n.parcelRequire3a97=r),r.register("27Lyk",(function(t,n){var a,o;e(t.exports,"register",(()=>a),(e=>a=e)),e(t.exports,"resolve",(()=>o),(e=>o=e));var r={};a=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)r[t[n]]=e[t[n]]},o=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("27Lyk").register(JSON.parse('{"ff4VL":"index.61e0b7b2.js","5FqY5":"img0.0209cc49.jpg","2MmLe":"img1.a33b6e0d.jpg","3CFfE":"img2.3de99596.jpg"}'));const s=e=>{localStorage.setItem("user",e)},c=async()=>{localStorage.removeItem("user")},l=async()=>await p(localStorage.getItem("user")+""),i=async({header:e,method:t,body:n,json:a=!0})=>{const o={headers:{Accept:"application/json","Content-type":"application/json"},body:n&&JSON.stringify(n),method:t},r=await fetch(`https://thesocialapp-62205-default-rtdb.europe-west1.firebasedatabase.app/${e}.json`,o);if(!r.ok)throw alert("API failed to fetch");if(a)return await r.json()},d=async e=>{const t=await m(),n=Object.values(t);return Object.getOwnPropertyNames(t).filter(((t,a)=>{if(n[a].email===e.email)return t}))},u=async(e,t)=>{const n=await(async e=>(await p(e.email)).posts)(e),a=null!=n?n:[];return a.push(t),e.posts=a,console.log(await d(e)),i({header:`users/${await d(e)}`,method:"PATCH",body:e,json:!0})},m=async()=>await i({header:"users",method:"GET",body:null,json:!0}),p=async e=>{const t=await m();return Object.values(t).filter((t=>t.email===e))[0]},f=async e=>{const t=await m();if(null!==t){if(Object.values(t).find((t=>t.email===e.email||t.username===e.username)))return alert("Email or username already exists")}return s(e.email),window.location.href="../index.html",i({header:"users",method:"POST",body:e,json:!0})},h=async e=>i({header:`users/${await d(e)}`,method:"DELETE",body:null,json:!0}),g=async(e,t)=>{const n=await m();if(0!==Object.values(n).filter((t=>{if(t.email===e.email&&t.password===e.password)return t})).length)return s(e.email),t&&(window.location.href="../index.html"),e;alert("User not found")},y=document.querySelector(".registerUser"),v=document.querySelector(".signinUser");let w;function E(){return w}function b(e){const t=document.querySelector(".email"),n=document.querySelector(".username"),a=document.querySelector(".password");var o=document.querySelector("input:checked");const r={email:t.value,password:a.value,username:"",img:"",posts:[]};if(e){r.username=n.value;var s;s=o.classList[0],r.img=s}return r}null!=y&&y.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),await f(b(!0))})),null!=v&&v.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),w=await g(b(!1),!0),null!=E()&&k()})),async function(){let e=await l();null!=e&&localStorage.getItem("user")&&(w=await g(e,!1),null!=E()&&k())}();var L={};L=new URL(r("27Lyk").resolve("5FqY5"),import.meta.url).toString();var S={};S=new URL(r("27Lyk").resolve("2MmLe"),import.meta.url).toString();var x={};x=new URL(r("27Lyk").resolve("3CFfE"),import.meta.url).toString();const j=document.querySelector(".container");async function k(){let e=document.querySelector(".signinBtn"),t=document.querySelector(".btns"),n=document.createElement("select"),a=document.createElement("option"),o=document.createTextNode(E().username),r=document.querySelector(".upload");a.appendChild(o);let s=document.createElement("option"),l=document.createTextNode("Logout");s.appendChild(l);let i=document.createElement("option"),d=document.createTextNode("Delete");i.appendChild(d),n.appendChild(a),n.appendChild(s),n.appendChild(i),t.appendChild(n),e.remove(),r.classList.add("show"),s.addEventListener("click",(function(a){n.remove(),console.log("Logging out..."),t.append(e),r.remove(),window.location.href="/FE22-js2-slutprojekt-Viktor-Johansson-ny/index.html",c()})),i.addEventListener("click",(async function(e){e.preventDefault(),await h(E()).then((e=>window.location.href="/FE22-js2-slutprojekt-Viktor-Johansson-ny/index.html"))})),null!=E().posts&&(E().posts.reverse(),a.addEventListener("click",(function(e){N(E())})))}function q(e){let n;switch(e){case"img0":n=t(L);break;case"img1":n=t(S);break;case"img2":n=t(x)}return n}function N(e){j.innerHTML="<div></div>";let t=document.createElement("div");const n=document.createElement("h1");n.style.textAlign="center",n.innerText=e.username,t.append(n);const a=document.createElement("img");a.className="userImage",a.src=q(e.img),t.append(a),j.append(t),t.className="postContainer",null!=e.posts&&e.posts.forEach((e=>{let n=document.createElement("div");n.className="postFrame";let a=document.createElement("p");a.innerText=e.text,n.append(a),t.append(n)}))}!async function(){const e=await m();const t=Object.values(e).sort(((e,t)=>e.posts&&t.posts?t.posts.length-e.posts.length:e.posts?-1:t.posts?1:0));t.forEach(((e,t)=>{const n=document.createElement("div"),a=document.createElement("div");a.className="postLayout card"+t;const o=document.createElement("img");o.className="userProfile card"+t,o.src=q(e.img),a.append(o),n.className="postCard card"+t;const r=document.createElement("h3");r.className="post card"+t,r.innerText=e.username,a.append(r);const s=document.createElement("h4");s.className="postAmount card"+t,null==e.posts?s.innerText="Posts: none":(s.innerText="Posts: "+e.posts.length,e.posts.reverse()),a.append(s),n.append(a),j.append(n)})),null!==j&&j.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation();const n=e.target;t.forEach(((e,t)=>{n.classList.contains("card"+t)&&N(e)}))}))}();const T=document.querySelector("#close-post"),C=document.querySelector("#postBox");C.classList.add("hide"),T.addEventListener("click",(e=>{C.classList.add("hide")}));let O=document.querySelector(".upload");const _=document.querySelector("#submit-button"),P=document.querySelector("#post-text");_.addEventListener("click",(async e=>{console.log(P.value),await u(E(),{text:P.value}),window.location.href="/FE22-js2-slutprojekt-Viktor-Johansson-ny/index.html"})),O.addEventListener("click",(e=>{C.classList.remove("hide")}));
//# sourceMappingURL=index.61e0b7b2.js.map
