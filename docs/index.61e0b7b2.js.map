{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-65695e612db72de4.js","src/ts/lib/auth.ts","src/ts/lib/api.ts","src/ts/module/login.ts","node_modules/@parcel/runtime-js/lib/runtime-a7cc07b24b12cb05.js","node_modules/@parcel/runtime-js/lib/runtime-a3d32a622ae18219.js","node_modules/@parcel/runtime-js/lib/runtime-8d198540b195b137.js","src/ts/index.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"ff4VL\\\":\\\"index.61e0b7b2.js\\\",\\\"5FqY5\\\":\\\"img0.0209cc49.jpg\\\",\\\"2MmLe\\\":\\\"img1.a33b6e0d.jpg\\\",\\\"3CFfE\\\":\\\"img2.3de99596.jpg\\\"}\"));","import { findUserFromEmail } from \"./api\";\r\n\r\nexport const storeUser = (email: string) => {\r\n    localStorage.setItem('user', email)\r\n};\r\n\r\nexport const removeUser = async () => {\r\n    localStorage.removeItem('user');\r\n};\r\n\r\nexport const hasLoggedIn = () => {\r\n    return localStorage.getItem('user');\r\n}\r\n\r\nexport const getUserFromStorage = async () => {\r\n    return await findUserFromEmail(localStorage.getItem('user') + \"\");\r\n};","import { storeUser } from \"./auth\";\r\n\r\nconst fetcher = async ({ header, method, body, json = true }) => {\r\n    const init = {\r\n        headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-type\": \"application/json\"\r\n        },\r\n        body: body && JSON.stringify(body),\r\n        method,\r\n    }\r\n\r\n    const res = await fetch(process.env.DATABASE_URL + `${header}.json`, init);\r\n    if (!res.ok) {\r\n        throw alert(\"API failed to fetch\");\r\n    }\r\n\r\n    if (json) {\r\n        return await res.json();\r\n    }\r\n};\r\n\r\ninterface User {\r\n    email: string,\r\n    password: string,\r\n    username: string,\r\n    img: string,\r\n    posts: { text: string }[]\r\n  }\r\n  \r\nexport const getId = async (user: User) => {\r\n    const existingUsers = await getUsers();\r\n    const values: object = Object.values(existingUsers);\r\n    return Object.getOwnPropertyNames(existingUsers).filter((usr: string, index) => {\r\n        if (values[index].email === user.email) {\r\n            return usr;\r\n        }\r\n    });\r\n}\r\n\r\nexport const getPostsFromUser = async (user: User) => {\r\n    const usr: User = await findUserFromEmail(user.email);\r\n    return usr.posts;\r\n}\r\n\r\nexport const uploadPost = async (user: User, post: {text:string}) => {\r\n    const posts:{text:string}[] = await getPostsFromUser(user)\r\n\r\n    const arr = posts != null ? posts : [];\r\n\r\n    arr.push(post);\r\n\r\n    user.posts = arr;\r\n    console.log(await getId(user));\r\n\r\n    return fetcher({\r\n        header: `users/${await getId(user)}`,\r\n        method: \"PATCH\",\r\n        body: user,\r\n        json: true,\r\n    });\r\n}\r\n\r\nexport const getUsers = async () => {\r\n    return (await fetcher({\r\n        header: \"users\",\r\n        method: \"GET\",\r\n        body: null,\r\n        json: true,\r\n    }));\r\n}\r\n\r\nexport const findUserFromEmail = async (email: string) => {\r\n    const existingUsers = await getUsers();\r\n    const userArr: Array<User> = Object.values(existingUsers);\r\n    const emailExists = userArr.filter(user => user.email === email);\r\n    return emailExists[0];\r\n}\r\n\r\nexport const register = async (user: User) => {\r\n    const existingUsers: User = await getUsers();\r\n\r\n    if (existingUsers !== null) {\r\n        const emailExists = Object.values(existingUsers).find(\r\n            (u: User) => u.email === user.email || u.username === user.username\r\n        );\r\n        if (emailExists) {\r\n            return alert(\"Email or username already exists\");\r\n        }\r\n    }\r\n\r\n    storeUser(user.email);\r\n\r\n    window.location.href = \"../index.html\";\r\n\r\n    return fetcher({\r\n        header: \"users\",\r\n        method: \"POST\",\r\n        body: user,\r\n        json: true,\r\n    });\r\n};\r\n\r\nexport const deleteUser = async (user: User) => {\r\n    return fetcher({\r\n        header: `users/${await getId(user)}`,\r\n        method: \"DELETE\",\r\n        body: null,\r\n        json: true,\r\n    });\r\n\r\n};\r\n\r\nexport const signin = async (user: User, navigate: boolean) => {\r\n    const existingUsers: User = await getUsers();\r\n\r\n    const emailExists = Object.values(existingUsers).filter(\r\n        (u: User) => { if (u.email === user.email && u.password === user.password/*comparePasswords(u.password, user.password)*/) return u; }\r\n    );\r\n\r\n\r\n    if (emailExists.length === 0) {\r\n        alert(\"User not found\");\r\n        return;\r\n    }\r\n\r\n\r\n    storeUser(user.email);\r\n    if (navigate)\r\n        window.location.href = \"../index.html\";\r\n\r\n    return user;\r\n};\r\n","import { loadUserSignedin } from \"../index\";\r\nimport { register, signin } from \"../lib/api\";\r\nimport { getUserFromStorage, hasLoggedIn } from \"../lib/auth\";\r\n\r\nconst registerUser = document.querySelector('.registerUser') as HTMLInputElement;\r\nconst signinUser = document.querySelector('.signinUser') as HTMLInputElement;\r\n\r\ninterface User {\r\n  email: string,\r\n  password: string,\r\n  username: string,\r\n  img: string,\r\n  posts: { text: string }[]\r\n}\r\n\r\nlet currentUser;\r\n\r\nexport function getCurrentUser() {\r\n  return currentUser;\r\n}\r\n\r\nif (registerUser != null)\r\n  registerUser.addEventListener(\"click\", async (e: Event) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    await register(getUserData(true));\r\n  })\r\n\r\nif (signinUser != null)\r\n  signinUser.addEventListener(\"click\", async (e: Event) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    currentUser = await signin(getUserData(false), true);\r\n    if (getCurrentUser() != null) loadUserSignedin();\r\n  })\r\n\r\nasync function checkForUser() {\r\n  let usr = await getUserFromStorage();\r\n  if (usr != null)\r\n    if (hasLoggedIn()) {\r\n      currentUser = await signin(usr, false);\r\n      if (getCurrentUser() != null) loadUserSignedin();\r\n    }\r\n}\r\n\r\ncheckForUser();\r\n\r\nfunction getUserData(register: boolean) {\r\n  const email = document.querySelector('.email') as HTMLInputElement;\r\n  const username = document.querySelector('.username') as HTMLInputElement;\r\n  const password = document.querySelector('.password') as HTMLInputElement;\r\n  var selected = document.querySelector('input:checked') as HTMLInputElement;\r\n\r\n  const user: User = {\r\n    email: email.value,\r\n    password: password.value,\r\n    username: \"\",\r\n    img: \"\",\r\n    posts: []\r\n  }\r\n\r\n\r\n  if (register) {\r\n    user[\"username\"] = username.value;\r\n    var className = \"\";\r\n    className = selected.classList[0];\r\n    user[\"img\"] = className;\r\n  }\r\n\r\n  return user;\r\n}","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"5FqY5\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"2MmLe\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"3CFfE\")).toString();","import { uploadPost, getUsers} from \"./lib/api\";\r\nimport { getCurrentUser } from \"./module/login\";\r\n\r\nimport { deleteUser } from \"./lib/api\";\r\nimport { removeUser} from \"./lib/auth\";\r\n\r\nimport img0 from '../images/img0.jpg';\r\nimport img1 from '../images/img1.jpg';\r\nimport img2 from '../images/img2.jpg';\r\n\r\nconst container = document.querySelector('.container') as HTMLInputElement;\r\n\r\nexport async function loadUserSignedin() {\r\n\r\n    let signinBtn = document.querySelector('.signinBtn') as HTMLInputElement;\r\n    let btns = document.querySelector('.btns') as HTMLInputElement;\r\n\r\n    let userSelect = document.createElement('select');\r\n    let userOption = document.createElement('option');\r\n\r\n    let userText = document.createTextNode(getCurrentUser().username);\r\n    let uploadBtn = document.querySelector('.upload') as HTMLInputElement;\r\n\r\n    userOption.appendChild(userText);\r\n  \r\n    let logoutOption = document.createElement('option');\r\n    let logoutText = document.createTextNode(\"Logout\");\r\n    logoutOption.appendChild(logoutText);\r\n    let deleteOption = document.createElement('option');\r\n    let deleteText = document.createTextNode(\"Delete\");\r\n    deleteOption.appendChild(deleteText);\r\n    userSelect.appendChild(userOption);\r\n    userSelect.appendChild(logoutOption);\r\n    userSelect.appendChild(deleteOption);\r\n  \r\n    btns.appendChild(userSelect);\r\n  \r\n    signinBtn.remove();\r\n    uploadBtn.classList.add('show');\r\n\r\n    logoutOption.addEventListener('click', function (e : Event) {\r\n      userSelect.remove();\r\n      console.log(\"Logging out...\");\r\n      btns.append(signinBtn);\r\n      uploadBtn.remove();\r\n      window.location.href = \"../index.html\";\r\n      removeUser();\r\n    });\r\n\r\n\r\n    deleteOption.addEventListener('click', async function (e : Event) {\r\n      e.preventDefault();\r\n      await deleteUser(getCurrentUser()).then(a => window.location.href = \"../index.html\");\r\n    });\r\n  \r\n    if (getCurrentUser().posts != null) {\r\n      getCurrentUser().posts.reverse();\r\n      userOption.addEventListener('click', function (e : Event) {\r\n        loadPostList(getCurrentUser());\r\n      });\r\n    }\r\n  }\r\n\r\nfunction getImage(type: string) {\r\n  let img;\r\n  switch (type) {\r\n    case \"img0\":\r\n      img = img0;\r\n      break;\r\n    case \"img1\":\r\n      img = img1;\r\n      break;\r\n    case \"img2\":\r\n      img = img2;\r\n      break;\r\n  }\r\n  return img;\r\n}\r\n\r\nloadUserList();\r\n\r\ninterface User {\r\n  email: string,\r\n  password: string,\r\n  username: string,\r\n  img: string,\r\n  posts: { text: string }[]\r\n}\r\n\r\n\r\nasync function loadUserList() {\r\n  const existingUsers = await getUsers();\r\n\r\n  let userArr: Array<User> = Object.values(existingUsers);\r\n  const list = userArr.sort((a: User, b: User) => {\r\n    \r\n    if (a.posts && b.posts) {\r\n      return b.posts.length - a.posts.length;\r\n    } else if (a.posts) {\r\n      return -1;\r\n    } else if (b.posts) {\r\n      return 1;\r\n    } else {\r\n      return 0;\r\n    }\r\n  });\r\n\r\n  list.forEach((users, index) => {\r\n    const postCard = document.createElement('div');\r\n    const post = document.createElement('div');\r\n    post.className = \"postLayout card\" + index;\r\n    const img = document.createElement('img');\r\n    img.className = \"userProfile card\" + index;\r\n    img.src = getImage(users.img);\r\n  \r\n    post.append(img);\r\n    postCard.className = \"postCard card\" + index;\r\n\r\n    const title = document.createElement('h3');\r\n    title.className = \"post card\" + index;\r\n    title.innerText = users.username;\r\n\r\n    post.append(title);\r\n    const posts = document.createElement('h4');\r\n    posts.className = \"postAmount card\" + index;\r\n    if (users.posts == null) {\r\n      posts.innerText = \"Posts: none\";\r\n    } else {\r\n      posts.innerText = \"Posts: \" + users.posts.length;\r\n      users.posts.reverse();\r\n    }\r\n    post.append(posts);\r\n\r\n    postCard.append(post);\r\n    container.append(postCard);\r\n  })\r\n\r\n  if (container !== null)\r\n    container.addEventListener('click', async (e : Event) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      const target = e.target as Element;\r\n\r\n      list.forEach((user: User, index) => {\r\n        if (target.classList.contains(\"card\" + index)) {\r\n          loadPostList(user);\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction loadPostList(user: User) {\r\n  container.innerHTML = \"<div></div>\";\r\n\r\n  let userProfile = document.createElement('div');\r\n\r\n  const title = document.createElement('h1');\r\n  title.style.textAlign = \"center\";\r\n  title.innerText = user.username;\r\n\r\n  userProfile.append(title);\r\n\r\n  const img = document.createElement('img');\r\n  img.className = \"userImage\";\r\n  img.src = getImage(user.img)\r\n  userProfile.append(img);\r\n  container.append(userProfile);\r\n  userProfile.className = \"postContainer\";\r\n\r\n \r\n  if (user.posts != null)\r\n  user.posts.forEach(post => {\r\n    let postFrame = document.createElement('div');\r\n    postFrame.className = \"postFrame\"\r\n    let postText = document.createElement('p');\r\n    postText.innerText = post.text;\r\n    postFrame.append(postText);\r\n    userProfile.append(postFrame);\r\n  })\r\n}\r\n\r\nconst close = document.querySelector('#close-post') as HTMLInputElement;\r\nconst box = document.querySelector('#postBox') as HTMLInputElement;\r\n\r\nbox.classList.add(\"hide\");\r\nclose.addEventListener(\"click\", (e : Event) => {\r\n  box.classList.add(\"hide\");\r\n})\r\n\r\nlet uploadBtn = document.querySelector('.upload') as HTMLInputElement;\r\n\r\nconst submit = document.querySelector('#submit-button') as HTMLInputElement;\r\nconst text = document.querySelector('#post-text') as HTMLInputElement;\r\n\r\nsubmit.addEventListener(\"click\", async (e : Event) => {\r\n  console.log(text.value);\r\n  await uploadPost(getCurrentUser(), { text: text.value })\r\n  window.location.href = \"../index.html\";\r\n})\r\n\r\nuploadBtn.addEventListener(\"click\", (e : Event) => {\r\n  box.classList.remove(\"hide\");\r\n})"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$b202d9fb56f0324d$export$40e2ef2cb1e7c393","email","localStorage","setItem","$b202d9fb56f0324d$export$d006f7a482b957ad","async","removeItem","$b202d9fb56f0324d$export$749108cc9a9ad565","$038b03d7e8996720$export$25619fe46b3e8158","getItem","$038b03d7e8996720$var$fetcher","header","method","body","json","init","headers","Accept","stringify","res","fetch","ok","alert","$038b03d7e8996720$export$218c8c3169c024d2","user","existingUsers","$038b03d7e8996720$export$925a4945a6cd0f3e","values","getOwnPropertyNames","filter","usr","index","$038b03d7e8996720$export$13ba04fdd9bedd7b","post","posts","$038b03d7e8996720$export$8c0f0943f09c1146","arr","push","console","log","$038b03d7e8996720$export$6503ec6e8aabbaf","find","u","username","window","location","href","$038b03d7e8996720$export$7d0f10f273c0438a","$038b03d7e8996720$export$54f63e0bb65a6adc","navigate","password","$be65a050e029dcc1$var$registerUser","document","querySelector","$be65a050e029dcc1$var$signinUser","$be65a050e029dcc1$var$currentUser","$be65a050e029dcc1$export$e5432d4c8eb97ea7","$be65a050e029dcc1$var$getUserData","selected","value","img","className","classList","addEventListener","e","preventDefault","stopPropagation","$4aa1cd84f89e5a94$export$9178578394ab4231","$be65a050e029dcc1$var$checkForUser","$73a480dafb617909$exports","URL","resolve","url","toString","$f597b9a082bf8f7d$exports","$c01f81ec13116041$exports","$4aa1cd84f89e5a94$var$container","signinBtn","btns","userSelect","createElement","userOption","userText","createTextNode","uploadBtn","appendChild","logoutOption","logoutText","deleteOption","deleteText","remove","add","append","then","a","reverse","$4aa1cd84f89e5a94$var$loadPostList","$4aa1cd84f89e5a94$var$getImage","type","$parcel$interopDefault","innerHTML","userProfile","title","style","textAlign","innerText","src","forEach","postFrame","postText","text","list","sort","b","users","postCard","target","contains","$4aa1cd84f89e5a94$var$loadUserList","$4aa1cd84f89e5a94$var$close","$4aa1cd84f89e5a94$var$box","$4aa1cd84f89e5a94$var$uploadBtn","$4aa1cd84f89e5a94$var$submit","$4aa1cd84f89e5a94$var$text"],"version":3,"file":"index.61e0b7b2.js.map"}